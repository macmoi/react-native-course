# Node.js
# Build a general Node.js project with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

pool:
  vmImage: macOS-latest
  
variables:
  group: AppDeploy

steps:
- task: DownloadSecureFile@1
  name: AndroidKeystore
  displayName: 'Download Android Keystore from secure files'
  inputs:
    secureFile: 'react-native-course.jks'

- task: NodeTool@0
  inputs:
    versionSpec: '14.x'
  displayName: 'Install Node.js'


# - bash: |
#     npm install
#     npm install -g expo-cli
#     npm install -g turtle-cli
#   displayName: 'npm, expo and turtle install'

- bash: |
    echo $env:M_EXPO_USER
    echo $env:M_EXPO_PASS
  env:
    M_EXPO_USER: $(EXPO_USER)
    M_EXPO_PASS: $(EXPO_PASS)
    M_ANDROID_KEYSTORE_PASSWORD: $(ANDROID_KEYSTORE_PASSWORD)
    M_ANDROID_KEY_PASSWORD: $(ANDROID_KEY_PASSWORD)
    M_ANDROID_KEY_ALIAS: $(ANDROID_KEY_ALIAS)
  displayName: 'expo and turtle build'

# - task: PublishBuildArtifacts@1
#   inputs:
#     PathtoPublish: "/users/runner/expo-apps/$(androidArtifact)"
#     ArtifactName: 'android'
#     publishLocation: 'Container'
#   displayName: 'Publish Android'
